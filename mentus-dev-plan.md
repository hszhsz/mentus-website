# Mentus 产品开发计划

> 版本: 1.1
> 更新日期: 2026-02-15
> 适用范围: MVP阶段（电脑端 + 云端）
> 开发策略: 本地开发优先，后期部署上云

---

## 一、项目概述

### 1.1 产品定位
Mentus是基于OpenClaw内核的个人AI助理产品，核心定位是"脑+手"（智慧思考+动手执行），主打极简易用、付费Skill生态、多端协同。

### 1.2 MVP范围
- ✅ 电脑端（Windows/MacOS/Linux）
- ✅ 云端服务（账号、同步、付费、Skill市场）
- ✅ 基础免费Skill（10个）
- ❌ 手机端（Flutter，MVP后开发）
- ❌ 职业Skill（MVP后开发）

### 1.3 技术栈

#### 开发阶段（本地）

| 模块 | 技术选型 | 说明 |
|-----|---------|------|
| 云端服务 | Nest.js + TypeScript | 统一技术栈 |
| 数据库 | PostgreSQL + Redis | Docker本地运行 |
| 消息队列 | BullMQ (Redis) | 本地Redis |
| 对象存储 | MinIO | 本地S3兼容存储 |
| WebSocket | Socket.io | 实时通信 |
| 支付 | 模拟服务 | 开发环境模拟 |
| 短信/邮件 | 模拟服务 | 控制台输出/MailHog |
| 电脑端 | Electron + React | 基于OpenClaw改造 |
| 容器化 | Docker Compose | 本地开发环境 |

#### 生产阶段（阿里云）

| 模块 | 技术选型 | 说明 |
|-----|---------|------|
| 云端服务 | Nest.js + TypeScript | 部署到ECS |
| 数据库 | PostgreSQL + Redis | 阿里云RDS + Redis |
| 消息队列 | BullMQ (Redis) | 阿里云Redis |
| 对象存储 | 阿里云OSS | 文件存储 |
| WebSocket | Socket.io | 负载均衡支持 |
| 支付 | 微信支付 + 支付宝 | 生产商户号 |
| 短信/邮件 | 阿里云短信 + SendGrid | 真实发送 |
| 容器化 | Docker + K8s | 阿里云ACK |

#### 部署策略

```
阶段一（第1-10周）：本地开发
├── 使用 Docker Compose 启动本地服务
├── 短信/支付使用模拟服务
├── 零云成本，快速迭代
└── 数据库数据可随时重置

阶段二（第11周）：测试环境
├── 申请最小化阿里云资源
├── 配置测试域名
├── 接入支付沙箱环境
└── 团队集成测试

阶段三（第14周）：生产环境
├── 申请生产环境资源
├── 域名备案完成
├── 接入真实支付商户号
└── 正式上线
```

---

## 二、架构设计

### 2.1 代码仓库划分

```
openclaw/                      # 开源内核（保持开源）
├── src/                       # 核心代码
├── skills/                    # 基础Skill
└── ...

mentus-cloud/                  # 云端服务（闭源商业）
├── apps/
│   ├── api-gateway/           # API网关
│   ├── user-service/          # 用户服务
│   ├── payment-service/       # 支付服务
│   ├── skill-service/         # Skill市场服务
│   └── sync-service/          # 同步服务
├── libs/
│   ├── shared/                # 共享模块
│   └── database/              # 数据库模块
├── docker-compose.yml         # 本地开发依赖（PG+Redis+MinIO）
└── docker-compose.prod.yml    # 生产环境配置

mentus-desktop/                # 电脑端（闭源商业）
├── src/
│   ├── main/                  # 主进程
│   ├── renderer/              # 渲染进程
│   └── openclaw-adapter/      # OpenClaw适配层
└── package.json

mentus-mobile/                 # 手机端Flutter（闭源商业，MVP后）
├── lib/
└── pubspec.yaml

mentus-admin/                  # 管理后台Web（闭源商业）
├── src/
└── package.json

mentus-website/                # 官网（闭源商业）
├── src/
└── package.json
```

### 2.2 系统架构图

```
┌─────────────────────────────────────────────────────────────────────┐
│                          用户层                                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐              │
│  │   电脑端      │  │   手机端      │  │   管理后台    │              │
│  │  (Electron)  │  │  (Flutter)   │  │    (Web)     │              │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘              │
└─────────┼─────────────────┼─────────────────┼──────────────────────┘
          │                 │                 │
          └─────────────────┼─────────────────┘
                            │ HTTPS/WSS
┌───────────────────────────▼─────────────────────────────────────────┐
│                        API网关 (Nest.js)                             │
│                   限流、认证、路由、日志                              │
└───────────────────────────┬─────────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        │                   │                   │
┌───────▼────────┐ ┌────────▼────────┐ ┌───────▼────────┐
│   用户服务      │ │   Skill服务     │ │   同步服务      │
│  user-service  │ │  skill-service  │ │  sync-service  │
└───────┬────────┘ └────────┬────────┘ └───────┬────────┘
        │                   │                   │
┌───────▼───────────────────▼───────────────────▼────────┐
│                      基础设施层                         │
│                                                        │
│  【开发环境】                  【生产环境】              │
│  ┌──────────┐               ┌──────────┐              │
│  │PostgreSQL│ (Docker)      │PostgreSQL│ (RDS)        │
│  │  Redis   │ (Docker)      │  Redis   │ (阿里云)      │
│  │  MinIO   │ (Docker)      │   OSS    │ (阿里云)      │
│  │ MailHog  │ (Docker)      │  SendGrid│ (邮件服务)    │
│  └──────────┘               └──────────┘              │
│                                                        │
└────────────────────────────────────────────────────────┘
```

### 2.3 OpenClaw与Mentus集成方式

```
┌─────────────────────────────────────────────┐
│           Mentus Desktop App                │
│  ┌─────────────────────────────────────┐   │
│  │        Electron 主进程               │   │
│  │  - 窗口管理                          │   │
│  │  - 系统托盘                          │   │
│  │  - 自动更新                          │   │
│  └─────────────────┬───────────────────┘   │
│                    │                        │
│  ┌─────────────────▼───────────────────┐   │
│  │      OpenClaw 内核 (Node.js)        │   │
│  │  ┌─────────┐ ┌─────────┐ ┌────────┐ │   │
│  │  │  Agent  │ │  Skills │ │ Memory │ │   │
│  │  │ Runtime │ │         │ │        │ │   │
│  │  └─────────┘ └─────────┘ └────────┘ │   │
│  └─────────────────────────────────────┘   │
│                    │                        │
│  ┌─────────────────▼───────────────────┐   │
│  │      Mentus 适配层 (Adapter)         │   │
│  │  - 云端账号连接                      │   │
│  │  - Skill市场客户端                   │   │
│  │  - 配置/记忆同步                     │   │
│  └─────────────────────────────────────┘   │
└─────────────────────────────────────────────┘
```

---

## 三、数据隐私设计

### 3.1 同步范围选择（用户可控）

用户在设置中可选择同步范围：

| 数据类型 | 描述 | 默认设置 |
|---------|------|---------|
| **用户配置** | 界面主题、快捷键、偏好设置 | ✅ 同步 |
| **Skill列表** | 已安装Skill的元数据（不含Skill包本身） | ✅ 同步 |
| **记忆索引** | 用户偏好、交互历史的向量索引 | ⚪ 可选 |
| **任务历史** | 历史任务记录和执行结果 | ⚪ 可选 |
| **本地文件** | 文件内容、文档数据 | ❌ 不同步 |
| **屏幕内容** | 截图、屏幕录制 | ❌ 不同步 |
| **敏感数据** | 密码、密钥、API Token | ❌ 不同步 |
| **聊天记录** | 与AI的对话内容 | ⚪ 可选 |

### 3.2 隐私模式

**模式A：云协同模式（默认）**
- 选择的同步数据会上传至云端
- 支持多端协同、数据备份
- 云端数据加密存储（AES-256）

**模式B：纯本地模式**
- 所有数据仅存本地
- 不支持云端同步、多端协同
- 可使用本地基础功能

### 3.3 数据安全措施

1. **传输加密**: 全站HTTPS + WSS
2. **存储加密**: 云端数据AES-256加密
3. **密码安全**: bcrypt存储，强制8位以上+复杂度
4. **审计日志**: 记录所有数据访问行为
5. **数据删除**: 账号注销后30天内彻底清除

---

## 四、迭代计划

### 迭代概览

| 迭代 | 周期 | 核心目标 | 详细文档 |
|-----|------|---------|---------|
| 迭代0 | 第1-2周 | 技术准备与架构搭建 | [迭代0文档](./iterations/iteration-0.md) |
| 迭代1 | 第3-4周 | 账号体系与认证 | [迭代1文档](./iterations/iteration-1.md) |
| 迭代2 | 第5-6周 | Skill市场基础 | [迭代2文档](./iterations/iteration-2.md) |
| 迭代3 | 第7-8周 | 云端同步与备份 | [迭代3文档](./iterations/iteration-3.md) |
| 迭代4 | 第9-10周 | 付费系统 | [迭代4文档](./iterations/iteration-4.md) |
| 迭代5 | 第11-12周 | 电脑端改造与集成 | [迭代5文档](./iterations/iteration-5.md) |
| 迭代6 | 第13-14周 | 官网、后台、测试 | [迭代6文档](./iterations/iteration-6.md) |
| MVP发布 | 第15周 | 上线准备 | [发布计划](./iterations/mvp-release.md) |

---

## 五、Skill生态规划

### 5.1 MVP阶段Skill（10个免费）

| Skill | 功能描述 | 来源 | 状态 |
|-------|---------|------|------|
| file-manager | 文件整理、搜索、分类 | 复用/改造 | 计划 |
| calendar | 日程管理、提醒 | 复用apple-reminders | 计划 |
| weather | 天气查询 | 复用weather | 计划 |
| notes | 笔记管理 | 复用obsidian | 计划 |
| browser | 浏览器控制 | 复用browser | 计划 |
| music | 音乐播放控制 | 复用spotify-player | 计划 |
| github | GitHub操作 | 复用github | 计划 |
| summarize | 文本摘要 | 复用summarize | 计划 |
| todo | 待办事项管理 | 新建 | 计划 |
| search | 网络搜索 | 新建 | 计划 |

### 5.2 Skill开发规范

```typescript
// Skill 元数据格式
interface SkillManifest {
  id: string;                    // 唯一标识
  name: string;                  // 显示名称
  version: string;               // 版本号
  description: string;           // 描述
  author: string;                // 作者
  category: 'daily' | 'career' | 'tool';  // 分类
  price: number;                 // 价格（0表示免费）
  permissions: Permission[];     // 权限声明
  requirements: Requirements;    // 运行要求
}

interface Permission {
  type: 'filesystem' | 'network' | 'browser' | 'system';
  scope: string;                 // 权限范围
  reason: string;                // 申请原因（展示给用户）
}
```

---

## 六、团队分工建议

| 角色 | 人数 | 职责 |
|-----|------|------|
| 后端开发 | 2-3人 | 云端服务开发、数据库设计 |
| 前端开发 | 1-2人 | 管理后台、官网 |
| 桌面端开发 | 1-2人 | Electron封装、OpenClaw适配 |
| 产品经理 | 1人 | 需求管理、交互设计 |
| UI设计师 | 1人 | 界面设计、视觉规范 |
| 测试工程师 | 1人 | 功能测试、性能测试 |
| 运维工程师 | 1人 | 阿里云部署、CI/CD |

---

## 七、风险与应对

| 风险 | 影响 | 应对方案 |
|-----|------|---------|
| OpenClaw内核适配复杂 | 高 | 提前进行技术预研，预留缓冲时间 |
| ~~云服务成本超预算~~ | ~~低~~ | ~~本地开发优先，发布前再上云~~ |
| 支付对接延迟 | 中 | 本地使用模拟服务，提前申请生产资质 |
| 域名备案延迟 | 高 | 第11周前启动备案申请 |
| 用户隐私担忧 | 高 | 透明隐私政策，提供纯本地模式 |
| MVP范围膨胀 | 高 | 严格按迭代计划执行，变更需评审 |
| 本地到云上迁移 | 中 | 使用Docker保持一致性，第11周预留迁移时间 |

---

## 八、验收标准

### 8.1 功能验收

- [ ] 账号注册/登录/找回密码正常运行
- [ ] Skill市场浏览、搜索、安装正常
- [ ] 配置同步/记忆同步/备份恢复正常
- [ ] 充值/购买/订单管理正常
- [ ] 电脑端安装向导≤3步完成
- [ ] 10个基础Skill可用

### 8.2 性能验收

- [ ] API响应时间 ≤ 200ms (P95)
- [ ] 同步延迟 ≤ 3秒
- [ ] 电脑端内存占用 ≤ 200MB
- [ ] 云端服务可用性 ≥ 99.9%

### 8.3 安全验收

- [ ] 通过安全渗透测试
- [ ] 支付流程符合PCI DSS要求
- [ ] 用户数据加密存储
- [ ] 完成隐私合规审查

---

## 九、附录

### 9.1 云资源规划

#### 阶段一：本地开发（第 1-10 周）

| 资源 | 方案 | 月成本 |
|-----|------|-------|
| 开发服务器 | Docker Desktop / 本地 Docker | ¥0 |
| 数据库 | PostgreSQL + Redis (Docker) | ¥0 |
| 对象存储 | MinIO (Docker) | ¥0 |
| 短信服务 | 控制台模拟输出 | ¥0 |
| 邮件服务 | MailHog (Docker) | ¥0 |
| 支付服务 | 本地模拟回调 | ¥0 |
| **总计** | | **¥0** |

#### 阶段二：测试环境（第 11-13 周）

| 资源 | 规格 | 月成本 | 用途 |
|-----|------|-------|------|
| ECS | 1台 2核4G | ¥200 | 测试服务器 |
| RDS PostgreSQL | 基础版 1核1G | ¥150 | 测试数据库 |
| Redis | 256MB | ¥50 | 测试缓存 |
| 域名 | mentus.ai | ¥100/年 | 备案用 |
| **首月总计** | | **~¥400** | |

#### 阶段三：生产环境（第 14 周起）

| 资源 | 规格 | 月成本 | 用途 |
|-----|------|-------|------|
| ECS | 2核4G × 2 | ¥400 | 应用服务器 |
| RDS PostgreSQL | 2核4G | ¥400 | 主数据库 |
| Redis | 1G | ¥150 | 缓存、消息队列 |
| OSS | 标准存储 | 按量 | 文件存储 |
| SLB | 标准型 | ¥100 | 负载均衡 |
| CDN | 按流量 | 按量 | 静态资源加速 |
| 短信服务 | 阿里云短信 | 按量 | 验证码发送 |
| **预估首月** | | **~¥1500** | 含初始流量包 |

### 9.2 域名规划

- `mentus.ai` - 主域名
- `app.mentus.ai` - 电脑端下载
- `cloud.mentus.ai` - 云端管理后台
- `api.mentus.ai` - API网关
- `www.mentus.ai` - 官网

### 9.3 相关文档

#### 核心计划
- [迭代0：技术准备](./iterations/iteration-0.md) - 本地开发环境搭建
- [迭代1：账号体系](./iterations/iteration-1.md)
- [迭代2：Skill市场](./iterations/iteration-2.md)
- [迭代3：云端同步](./iterations/iteration-3.md)
- [迭代4：付费系统](./iterations/iteration-4.md)
- [迭代5：电脑端改造](./iterations/iteration-5.md)
- [迭代6：官网与后台](./iterations/iteration-6.md)
- [MVP发布计划](./iterations/mvp-release.md)

#### 开发指南
- [本地开发指南](./local-development-guide.md) - Docker环境配置、Mock服务使用
